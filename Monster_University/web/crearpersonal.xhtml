<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/template.xhtml">
    
    <ui:define name="title">Crear Nueva Persona</ui:define>

    <ui:define name="body">
        <div class="form-container" style="max-width: 800px; margin: 0 auto; padding: 20px; background-color: rgba(255, 255, 255, 0.95); border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: relative; z-index: 1;">
            
            <script>
                function debug(message) {
                    console.log("[DEBUG] " + message);
                }
                
                function debugError(message) {
                    console.error("[ERROR] " + message);
                }
                
                function debugSuccess(message) {
                    console.log("‚úÖ " + message);
                }
                
                console.log("=== FORMULARIO CREAR PERSONA CARGADO ===");
                
                document.addEventListener('DOMContentLoaded', function() {
                    console.log("üìù INSTRUCCIONES:");
                    console.log("1. Llena el formulario");
                    console.log("2. Los campos con * son obligatorios");
                    console.log("3. Estado Civil, Sexo y Celular son opcionales");
                    console.log("4. Haz click en 'Crear Persona'");
                });
            </script>
            
            <style>
                .form-header {
                    text-align: center;
                    margin-bottom: 30px;
                    border-bottom: 2px solid #2a64c5;
                    padding-bottom: 10px;
                }
                
                .form-header h1 {
                    color: #2a64c5;
                    font-size: 2rem;
                    margin-bottom: 5px;
                }
                
                .form-header p {
                    color: #666;
                    font-size: 1rem;
                }
                
                .form-group {
                    margin-bottom: 20px;
                    padding: 10px;
                    border-radius: 5px;
                    background-color: #f8f9fa;
                }
                
                .form-label {
                    display: block;
                    margin-bottom: 8px;
                    font-weight: bold;
                    color: #495057;
                    font-size: 0.9rem;
                }
                
                .form-required {
                    color: #dc3545;
                    margin-left: 3px;
                }
                
                .form-actions {
                    margin-top: 30px;
                    text-align: center;
                    padding-top: 20px;
                    border-top: 1px solid #dee2e6;
                }
                
                .form-help {
                    margin-top: 15px;
                    padding: 10px;
                    background-color: #e7f3ff;
                    border-left: 4px solid #2a64c5;
                    font-size: 0.9rem;
                    color: #666;
                }
                
                .form-row {
                    display: flex;
                    gap: 15px;
                    margin-bottom: 15px;
                }
                
                .form-column {
                    flex: 1;
                }
                
                .field-hint {
                    font-size: 0.8rem;
                    color: #666;
                    margin-top: 5px;
                    font-style: italic;
                }
                
                .radio-group {
                    display: flex;
                    gap: 20px;
                    margin-top: 5px;
                    flex-wrap: wrap;
                }
                
                .radio-option {
                    display: flex;
                    align-items: center;
                    gap: 5px;
                }
                
                .radio-label {
                    font-weight: normal;
                    color: #495057;
                    font-size: 0.9rem;
                }
            </style>
            
            <div class="form-header">
                <h1>üë§ Crear Nueva Persona</h1>
                <p>Complete los datos para registrar una nueva persona en el sistema</p>
            </div>
            
            <h:form id="formCrearPersona">
                <p:panel header="Datos Personales" styleClass="form-panel" style="border: none; background: transparent;">
                    
                    <div class="form-row">
                        <!-- ID Persona (Generado autom√°ticamente) -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperId" value="ID Persona" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:inputText id="peperId" value="#{crearPersonaController.idGenerado}" 
                                           style="width: 100%; background-color: #e9ecef;"
                                           readonly="true"
                                           placeholder="Se genera autom√°ticamente"/>
                                <div class="field-hint">(Generado autom√°ticamente)</div>
                                <!-- Campo oculto para mantener el valor -->
                                <h:inputHidden value="#{crearPersonaController.nuevaPersona.peperId}"/>
                            </div>
                        </div>
                        
                        <!-- Tipo de Persona -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperTipo" value="Tipo de Persona" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:selectOneMenu id="peperTipo" value="#{crearPersonaController.nuevaPersona.peperTipo}" 
                                               style="width: 100%;"
                                               onchange="debug('Tipo de persona seleccionado: ' + this.value)"
                                               required="true"
                                               requiredMessage="Debe seleccionar un tipo">
                                    <f:selectItem itemLabel="Seleccione tipo" itemValue=""/>
                                    <f:selectItem itemLabel="Administrador del Sistema" itemValue="Administrador del Sistema"/>
                                    <f:selectItem itemLabel="Docente" itemValue="Docente"/>
                                    <f:selectItem itemLabel="Administrador de matr√≠culas" itemValue="Administrador de matriculas"/>
                                    <f:selectItem itemLabel="Secretar√≠a Acad√©mica" itemValue="Secretaria Academica"/>
                                </p:selectOneMenu>
                                <p:message for="peperTipo" display="icon"/>
                            </div>
                        </div>
                    </div>

                    <!-- Fila 2: Nombre y Apellido -->
                    <div class="form-row">
                        <!-- Nombre -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperNombre" value="Nombre" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:inputText id="peperNombre" value="#{crearPersonaController.nuevaPersona.peperNombre}" 
                                           maxlength="25" style="width: 100%;"
                                           placeholder="Ingrese el nombre"
                                           onchange="debug('Nombre cambiado: ' + this.value)"
                                           required="true"
                                           requiredMessage="El nombre es requerido"/>
                                <div class="field-hint">(M√°ximo 25 caracteres)</div>
                                <p:message for="peperNombre" display="icon"/>
                            </div>
                        </div>
                        
                        <!-- Apellido -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperApellido" value="Apellido" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:inputText id="peperApellido" value="#{crearPersonaController.nuevaPersona.peperApellido}" 
                                           maxlength="25" style="width: 100%;"
                                           placeholder="Ingrese el apellido"
                                           onchange="debug('Apellido cambiado: ' + this.value)"
                                           required="true"
                                           requiredMessage="El apellido es requerido"/>
                                <div class="field-hint">(M√°ximo 25 caracteres)</div>
                                <p:message for="peperApellido" display="icon"/>
                            </div>
                        </div>
                    </div>

                    <!-- Fila 3: C√©dula y Celular -->
                    <div class="form-row">
                        <!-- C√©dula -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperCedula" value="C√©dula" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:inputText id="peperCedula" value="#{crearPersonaController.nuevaPersona.peperCedula}" 
                                           maxlength="15" style="width: 100%;"
                                           placeholder="Ej: 1234567890"
                                           onchange="debug('C√©dula cambiada: ' + this.value)"
                                           required="true"
                                           requiredMessage="La c√©dula es requerida"/>
                                <div class="field-hint">(M√°ximo 15 caracteres)</div>
                                <p:message for="peperCedula" display="icon"/>
                            </div>
                        </div>
                        
                        <!-- Celular (Opcional) -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperCelular" value="Celular" styleClass="form-label"/>
                                <p:inputText id="peperCelular" value="#{crearPersonaController.nuevaPersona.peperCelular}" 
                                           maxlength="15" style="width: 100%;"
                                           placeholder="Ej: 0991234567 (opcional)"
                                           onchange="debug('Celular cambiado: ' + this.value)"/>
                                <div class="field-hint">(M√°ximo 15 caracteres, opcional)</div>
                                <p:message for="peperCelular" display="icon"/>
                            </div>
                        </div>
                    </div>

                    <!-- Fila 4: Email y Fecha -->
                    <div class="form-row">
                        <!-- Email -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="peperEmail" value="Email" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:inputText id="peperEmail" value="#{crearPersonaController.nuevaPersona.peperEmail}" 
                                             maxlength="30" style="width: 100%;"
                                             placeholder="ejemplo@correo.com"
                                             onchange="debug('Email cambiado: ' + this.value)"
                                             required="true"
                                             requiredMessage="El email es requerido">
                                    <f:validateRegex pattern="^[A-Za-z0-9+_.-]+@(.+)$" />
                                </p:inputText>
                                <div class="field-hint">(M√°ximo 30 caracteres)</div>
                                <p:message for="peperEmail" display="icon"/>
                            </div>
                        </div>

                        <!-- Fecha de Ingreso -->
                        <div class="form-column">
                            <div class="form-group">
                                <h:outputLabel for="pepeperFechIngr" value="Fecha de Ingreso" styleClass="form-label"/>
                                <span class="form-required">*</span>
                                <p:calendar id="pepeperFechIngr" value="#{crearPersonaController.nuevaPersona.pepeperFechIngr}" 
                                            style="width: 100%;"
                                            pattern="dd/MM/yyyy" 
                                            locale="es" 
                                            showOn="button"
                                            placeholder="Seleccione fecha"
                                            onchange="debug('Fecha de ingreso cambiada: ' + this.value)"
                                            required="true"
                                            requiredMessage="La fecha de ingreso es requerida">
                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                </p:calendar>
                                <p:message for="pepeperFechIngr" display="icon"/>
                            </div>
                        </div>
                    </div>

                    <!-- Fila 5: Sexo y Estado Civil -->
                    <div class="form-row">
    <!-- Sexo (Obligatorio) - Usando radio buttons -->
    <div class="form-column">
        <div class="form-group">
            <h:outputLabel for="codigoSexoSeleccionado" value="Sexo" styleClass="form-label"/>
            <span class="form-required">*</span>
            <p:selectOneRadio id="codigoSexoSeleccionado" 
                            value="#{crearPersonaController.codigoSexoSeleccionado}"
                            layout="custom"
                            required="true"
                            requiredMessage="Debe seleccionar el sexo">
                <f:selectItem itemLabel="Masculino" itemValue="M"/>
                <f:selectItem itemLabel="Femenino" itemValue="F"/>
                <f:selectItem itemLabel="Otro" itemValue="O"/>
            </p:selectOneRadio>
            <div class="radio-group">
                <div class="radio-option">
                    <p:radioButton id="sexoM" for="codigoSexoSeleccionado" itemIndex="0"/>
                    <h:outputLabel for="sexoM" value="Masculino" styleClass="radio-label"/>
                </div>
                <div class="radio-option">
                    <p:radioButton id="sexoF" for="codigoSexoSeleccionado" itemIndex="1"/>
                    <h:outputLabel for="sexoF" value="Femenino" styleClass="radio-label"/>
                </div>
                
            </div>
            <p:message for="codigoSexoSeleccionado" display="icon"/>
        </div>
    </div>
                        
                        <!-- Estado Civil (Opcional) - Versi√≥n simplificada -->
                       
                    </div>

                    <!-- Ayuda -->
                    <div class="form-help">
                        <p><strong>üìã Informaci√≥n importante:</strong></p>
                        <p>‚Ä¢ <span class="form-required">*</span> Campos obligatorios</p>
                        <p>‚Ä¢ El ID de persona se genera autom√°ticamente</p>
                        <p>‚Ä¢ La fecha de ingreso es la fecha en que la persona ingres√≥ a la instituci√≥n</p>
                        <p>‚Ä¢ El sexo es obligatorio para completar el registro</p>
                        <p>‚Ä¢ El estado civil es opcional</p>
                    </div>

                    <!-- Botones de acci√≥n -->
                    <div class="form-actions">
                        <p:commandButton value="üíæ Crear Persona" 
                                       action="#{crearPersonaController.crearPersona}"
                                       update="@form :growl"
                                       icon="pi pi-save"
                                       styleClass="ui-button-primary"
                                       style="margin-right: 10px; padding: 8px 20px;"
                                       onstart="debug('=== INICIANDO CREACI√ìN DE PERSONA ===');
                                                console.log('Validando formulario...');"
                                       oncomplete="if(!args.validationFailed) { 
                                                   debugSuccess('Persona creada exitosamente!');
                                                   } else {
                                                   debugError('Error en el formulario');
                                                   }"/>
                        
                        <p:commandButton value="üîÑ Limpiar" 
                                       action="#{crearPersonaController.initNuevaPersona}"
                                       update="@form :growl"
                                       immediate="true"
                                       icon="pi pi-refresh"
                                       styleClass="ui-button-secondary"
                                       style="margin-right: 10px; padding: 8px 20px;"
                                       onstart="debug('Limpiando formulario...')"/>
                        
                        <p:button value="‚Ü©Ô∏è Cancelar" 
                                icon="pi pi-times"
                                outcome="/index.xhtml"
                                style="padding: 8px 20px;"/>
                    </div>
                </p:panel>
            </h:form>
        </div>
    </ui:define>

    <ui:define name="footer">
        <div style="width: 100%; text-align: center; font-size: 0.9rem; color: #666;">
            ¬© #{java.time.LocalDate.now().year} Monster University - Sistema de Gesti√≥n Acad√©mica
        </div>
    </ui:define>
</ui:composition>